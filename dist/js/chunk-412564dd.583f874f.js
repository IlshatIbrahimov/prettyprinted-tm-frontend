(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-412564dd"],{"1d21":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("header",{staticClass:"header"},[a("h1",{staticClass:"header__title"},[t._v(t._s(t.task.project.name))])]),a("div",{staticClass:"task"},[a("div",{staticClass:"task__left scroll"},[a("div",{staticClass:"task__header"},[a("div",{staticClass:"task__header-item"},[a("button",{staticClass:"task__header-btn task__header-btn--back",on:{click:function(e){return e.preventDefault(),t.action(e)}}},[a("small"),a("span",[t._v("back")])]),a("span",{staticClass:"task__header-subtitle"},[t._v("task-"+t._s(t.task.id))])]),a("div",{staticClass:"task__header-item task__header-item--buttons"},[a("button",{staticClass:"task__header-btn task__header-btn--edit",on:{click:function(e){return e.preventDefault(),t.editTask(e)}}}),a("b-button",{staticClass:"task__header-btn task__header-btn--delete",on:{click:function(e){return e.preventDefault(),t.deleteTask(e)}}})],1)]),a("div",{staticClass:"task__content"},[t.isEdit?a("b-form",{staticClass:"task__content-wrapper horizontal-separate"},[a("b-form-group",[a("b-form-input",{staticClass:"form__input-field",attrs:{id:"nameTask",type:"text",state:t.validateState("name")},model:{value:t.$v.task.name.$model,callback:function(e){t.$set(t.$v.task.name,"$model",e)},expression:"$v.task.name.$model"}}),this.$v.task.name.required?t._e():a("b-form-invalid-feedback",{attrs:{id:"input"}},[t._v("This field is required. ")]),this.$v.task.name.maxLength?t._e():a("b-form-invalid-feedback",{attrs:{id:"input"}},[t._v("The name must be at most 140 characters long. ")])],1),a("b-form-group",[a("b-form-textarea",{staticClass:"form__textarea-field",attrs:{id:"content",type:"text",state:t.validateState("content")},model:{value:t.$v.task.content.$model,callback:function(e){t.$set(t.$v.task.content,"$model",e)},expression:"$v.task.content.$model"}}),this.$v.task.content.maxLength?t._e():a("b-form-invalid-feedback",{attrs:{id:"textarea"}},[t._v("The content must be at most 1000 characters long. ")])],1),a("button",{staticClass:"button w-25",on:{click:function(e){return e.preventDefault(),t.updateTask(e)}}},[t._v("Save ")])],1):a("div",{staticClass:"task__content-wrapper horizontal-separate"},[a("div",{staticClass:"task__content-title"},[a("span",{staticClass:"task__header-title"},[t._v(t._s(t.task.name))])]),a("div",{staticClass:"task__text"},[a("p",[t._v(t._s(t.task.content))])])]),a("Comment",{staticClass:"comments",attrs:{comments:t.task.comments},on:{addComment:t.addComment}})],1)]),a("div",{staticClass:"task__right"},[a("h2",{staticClass:"state"},[t._v("State:")]),a("div",{staticClass:"attributes attributes--task"},[a("div",{staticClass:"attributes__item"},[a("label",{staticClass:"attributes__label"},[t._v("Created by:")]),a("span",{staticClass:"select select--disabled"},[t._v(t._s(t.task.author.name)+" "+t._s(t.task.author.surname))])]),t._l(t.$root.attributes,(function(e,n,s){return a("form",{key:s,staticClass:"attributes__item",on:{change:function(e){return t.updateTask(n)}}},[a("label",{staticClass:"attributes__label"},[t._v(t._s(n)+":")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.task[n].id,expression:"task[name].id"}],staticClass:"select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.task[n],"id",e.target.multiple?a:a[0])}}},t._l(e,(function(e,n){return a("option",{key:n,staticClass:"select__option",domProps:{value:n}},[t._v(t._s(e.name)+" ")])})),0)])})),a("form",{staticClass:"attributes__item",on:{change:t.updateTask}},[a("label",{staticClass:"attributes__label",attrs:{for:"assignee"}},[t._v("Assignee:")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.task.assignee.id,expression:"task.assignee.id"}],staticClass:"select",attrs:{id:"assignee"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.task.assignee,"id",e.target.multiple?a:a[0])}}},t._l(t.users,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name)+" "+t._s(e.surname)+" ")])})),0)])],2)])])])},s=[],r=(a("b0c0"),a("5530")),i=(a("96cf"),a("1da1")),c=a("35ca"),o=a("d8e7"),u=a("e5f0"),l=a("4ea3"),d=a("1dce"),m=a("b5ae"),k={name:"Task",mixins:[d["validationMixin"]],data:function(){return{users:[],task:{id:null,name:"",content:"",comments:[],project:{id:null,name:""},type:{id:null,name:""},priority:{id:null,name:""},status:{id:null,name:""},author:{id:null,name:"",surname:""},assignee:{id:null,name:"",surname:""}},isEdit:!1,comment:""}},components:{Comment:l["a"]},validations:{task:{name:{required:m["required"],maxLength:Object(m["maxLength"])(140)},content:{maxLength:Object(m["maxLength"])(1e3)}}},methods:{validateState:function(t){var e=this.$v.task[t],a=e.$dirty,n=e.$error;return a?!n:null},fetchUsers:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].getAll().then((function(t){return t})).catch((function(t){return console.log(t)}));case 2:a=e.sent,t.users=a.data;case 4:case"end":return e.stop()}}),e)})))()},fetchTask:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].getById(t.$route.params.id).then((function(e){t.task=Object(r["a"])({},e.data)})).catch((function(t){return console.log(t.response)}));case 2:case"end":return e.stop()}}),e)})))()},updateTask:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$v.task.$touch(),!t.$v.task.$anyError){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,o["a"].updateTask({id:t.task.id,name:t.task.name,content:t.task.content,assigneeId:+t.task.assignee.id,priorityId:+t.task.priority.id,statusId:+t.task.status.id,typeId:+t.task.type.id}).then((function(e){t.task=Object(r["a"])({},e.data),console.log(e)})).catch((function(t){return console.log(t)}));case 5:t.isEdit=!1;case 6:case"end":return e.stop()}}),e)})))()},deleteTask:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"].deleteTask(t.$route.params.id).then((function(e){200===e.status?t.$router.push("/project/".concat(t.$route.params.projectId)):console.log("Что-то пошло не так!")}));case 2:case"end":return e.stop()}}),e)})))()},addComment:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,u["a"].addComment({content:t,id:e.task.id}).then((function(t){e.fetchTask(),console.log("addComment",t)})).catch((function(t){return t}));case 2:case"end":return a.stop()}}),a)})))()},action:function(){this.$router.push("/project/".concat(this.$route.params.projectId))},editTask:function(){this.isEdit=!this.isEdit}},mounted:function(){this.fetchTask(),this.fetchUsers()}},_=k,v=a("2877"),p=Object(v["a"])(_,n,s,!1,null,null,null);e["default"]=p.exports},d8e7:function(t,e,a){"use strict";var n=a("d4ec"),s=a("bee2"),r=a("c427"),i=function(){function t(){Object(n["a"])(this,t)}return Object(s["a"])(t,[{key:"getById",value:function(t){return Object(r["a"])().get("/task/".concat(t))}},{key:"getByAuthUser",value:function(){return Object(r["a"])().get("/task/user")}},{key:"addTask",value:function(t){return Object(r["a"])().post("/task",t)}},{key:"updateTask",value:function(t){return Object(r["a"])().put("/task",t)}},{key:"deleteTask",value:function(t){return Object(r["a"])().delete("/task/".concat(t))}}]),t}();e["a"]=new i}}]);
//# sourceMappingURL=chunk-412564dd.583f874f.js.map